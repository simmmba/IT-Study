# TCP, UDP & 포트(port)

### TCP

 TCP는 신뢰성있는 통신이 필요로 한 어플리케이션을 위해 점대점 채널을 제공합니다. 하이퍼텍스트 전송 프로토콜(HTTP), 파일 전송 프로토콜(FTP) 및 텔넷은 신뢰할 수 있는 통신 채널이 필요로 한 어플리케이션입니다. 데이터가 네트워크를 통해 전송 및 수신되는 순서는 이들 어플리케이션의 성공에 매우 중요합니다. HTTP로 URL에서 데이터를 읽을 때 데이터는 보내진 순서대로 수신되어야 합니다. 그렇지 않으면 뒤죽박죽된 HTML 파일, 손상된 압축 파일 또는 다른 잘못된 정보를 받게 됩니다.

- Application: HTTP, ftp, telnet, SMTP, ...
- Transport: TCP, UDP, ...
- Network: IP, ...
- Link: Device, driver, ...

 전송 프로토콜(Transport protocols)은 하나의 포트에서 다른 포트로 정보를 전달해 어플리케이션 프로그램간의 통신을 가능하게 하기 위해 사용됩니다. 이들은 연결지향 또는 비연결지향 통신 방식 중 하나를 사용합니다. TCP는 연결 지향형 프로토콜이며 UDP는 비연결 지향형 전송 프로토콜입니다.

 연결 지향형 프로토콜 TCP는 출발지 포트/IP 주소와 도착지 포트/IP 주소 간의 통신 연결을 수립합니다. 연결이 종료되고 링크가 끊어질 때까지 포트들은 이 링크를 통해 서로 연결됩니다. 연결 지향 프로토콜의 한 예가 전화 통화입니다. 전화 연결이 수립되어 통신이 이루어진 다음 연결이 종료됩니다. 출발지와 도착지 사이의 통신의 신뢰는 TCP 내에 구현된 에러 탐지(error-detection), 에러 정정(error-correction) 메커니즘을 통해 보장됩니다. TCP는 출발지에서 목적지까지의 바이트 스트림으로연결을 구현합니다. 이 기능은 java.io에서 제공되는 스트림 I/O 클래스들로 사용할 수 있습니다.



<br />



### UDP

 UDP 프로토콜은 네트워크에 있는 두 개의 응용 프로그램 간의 보장할 수 없는 통신을 제공합니다. UDP는 TCP같은 연결기반이 아닙니다. 한 어플리케이션에서 다른 어플리케이션으로 데이터그램(Datagram)이라고 부르는 독립적인 데이터 패킷을 전송합니다. 데이터그램 전송은 우편 서비스를 통해 편지를 보내는 것과 매우 유사합니다. 배달 순서는 중요하지 않고 각 메시지는 다른 메시지와 독립적입니다.

 UDP(User Datagram Protocol)는 한 컴퓨터에서 다른 컴퓨터고 데이터그램이라 불리는 독립적인 데이터 패킷을 전송하는 프로토콜입니다. 이 프로토콜은 데이터의 도착을 보장하지 않습니다. UDP는 TCP처럼 연결 기반이 아닙니다. 많은 어플리케이션의 경우 신뢰 보장은 연결의 한쪽 종단에서 다른 쪽의 종단간의 정보 교환 성공을 위한 핵심입니다. 그러나 다른 형태의 의사 소통은 엄격한 기준이 필요하지 않습니다.

 사실 그들은 추가적인 오버헤드에 의해 느려지거나 신뢰성있는 연결로 인해 모든 서비스를 무효화할 수 있습니다. 예를 들어 요청이 있을 때 현재 시간을 자신의 클라이언트에게 전송하는 타임 서버를 생각해 봅시다. 클라이언트가 패킷을 놓쳐서 놓친 패킷을 클라이언트에 재전송하면 클라이언트가 받을 떄 잘못된 시간을 받게 되므로 상식적으로 문제가 있습니다. 클라이언트가 요청을 두 번 보냈는데 서버로부터 순서가 바뀐 패킷을 수신했을 경우 클라이언트가 이를 알아차리고 재전송을 요청하는 것도 말이 안됩니다.

 이런 경우, TCP의 신뢰성이 성능을 저하시키고 유용성을 저해할 수 있기 때문에 불필요합니다. 신뢰성이 보장되는 채널이 필요없는 서비스의 또 다른 예는 ping 명령입니다. ping 명령의 목적은 네트워크에서 두 프로그램의 통신을 테스트하는 것입니다. 사실 ping은 연결 상태가 좋은지 나쁜지 결정하기 위해 패킷을 잃어버리거나 패킷의 순서가 뒤죽박죽 되는지에 대해 알아야 합니다.

 UDP는 비연결 지향 프로토콜로 연결을 지속하기 위한 링크를 설립하지 않는다는 점에서 연결지향 프로토콜인 TCP와 다릅니다. 비연결지향 프로토콜의 예로는 우편이 있습니다. 우편을 보내기 위해서는 보내고자 하는 우편물의 봉투에 목적지 주소(선택 사항으로 반송지 주소)를 쓰고 우편함에 넣습니다. UDP를 사용할 때, 응용 프로그램은 데이터그램에 목적지 포트와 IP 주소를 기록하고 그 목적지로 데이터그램을 전송합니다. UDP는 프로토콜 내 내장된 전달을 보증하거나 에러를 탐지하거나 에러를 교정하는 메커니즘이 없기 때문에 TCP보다 신뢰할 수 없습니다.

 FTP, SMTP 그리고 TCP 같은 어플리케이션 프로토콜은 클라이언트와 서버 프로그램 간의 신뢰할 수 있는 스트림 기반 통신을 제공하기 위해 TCP를 사용합니다. Time Protocol 같은 다른 프로토콜은 단대단(end-to-end)의 신뢰성보다 전달 속도가 더 중요하기 때문에 UDP를 사용합니다.



<br />



### 포트 이해하기

 일반적으로 컴퓨터는 네트워크에 물리적인 단일 연결을 가집니다. 특정 컴퓨터로 향하는 모든 데이터는 해당 연결을 통해 도착합니다. 그러나 데이터는 컴퓨터에서 실행하는 다른 응용프로그램을 위한 것일 수 있습니다. 그러면 컴퓨터는 데이터를 전달해야 할 응용 프로그램을 어떻게 알 수 있을까요? 포트를 통해서입니다.

 인터넷을 통해 교환되는 데이터는 컴퓨터와 목적 포트를 식별하기 위한 위치 정보를 동반합니다. 컴퓨터는 네트워크에서 알맞은 컴퓨터에 데이터를 전달하기 위해 사용하는 32개 비트의 IP 주소로 식별됩니다. TCP와 UDP는 알맞은 어플리케이션에 데이터를 배달하기 위해 사용하는 16개 비트로 구성된 수로 식별됩니다. TCP같은 연결 기반 통신에서 서버 응용 프로그램은 특정 번호의 포트에 소켓을 바인드(bind)합니다. 이것은 해당 포트로 향하는 모든 데이터를 수신하기 위해 서버를 시스템에 등록하는 효과를 가집니다. 그러면 아래 그림에 묘사된 것처럼 클라이언트는 서버의 포트에서 서버와 만나게 됩니다.

![port1](https://github.com/simmmba/IT_Study/blob/master/images/port1.png?raw=true)

 TCP와 UDP 프로토콜은 컴퓨터에서 실행하는 특정 프로세스와 들어오는 데이터를 매핑하기 위해 포트를 사용합니다. 아래 그림과 같이 UDP 같은 데이터그램 기반의 통신에서 데이터그램 패킷은 자신의 목적 포트 번호를 포함하여 알맞은 어플리케이션으로 패킷을 라우트 합니다.

![port2](https://github.com/simmmba/IT_Study/blob/master/images/port2.png?raw=true)

 포트 번호의 범위는 16개 비트의 수로 표현되기 때문에 0~65,535 까지입니다. 0에서 1024 까지의 포트 번호는 제한된 포트들입니다. 이들은 HTTP, FTP 그리고 다른 시스템 서비스처럼 잘 알려진 서비스를 위해 예약되어 있습니다. 이 포트들을 잘 알려진(well-known) 포트라고 합니다. 사용자의 어플리케이션들을 여기에 바인드해서는 안됩니다.

| 포트 | <center> 프로토콜 </center>   |
| :--: | :---------------------------- |
|  21  | File Transfer Protocol        |
|  23  | Telnet Protocol               |
|  25  | Simple Mail Transfer Protocol |
|  80  | Hypertext Transfer Protocol   |

